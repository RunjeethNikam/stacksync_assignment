name: "sandbox_env"
hostname: "python3-box"
mode: ONCE
log_level: ERROR

# Working directory inside the container
cwd: "/tmp"

# Set environment variables required during execution
envar: "HOME=/user"
envar: "LD_LIBRARY_PATH=/usr/local/lib"

# Disable advanced readline features (safer execution)
disable_rl: true

# Isolation flags â€“ keep them off to match current setup
clone_newuser: false
clone_newnet: false
clone_newpid: false
clone_newipc: false
clone_newuts: false
clone_newns: false
clone_newcgroup: false

# Define the executable and arguments
exec_bin {
  path: "/usr/local/bin/python3"
  arg: "python3"
  arg: "/sandbox/tmp/script.py"  # Target script path inside jail
}

# Restrict dangerous syscalls with a custom seccomp profile
seccomp_string: "KILL { fchmod, setresuid, fchmodat, setuid, lchown, setfsgid, setfsuid, umount, chown, setgid, setregid, fchown, setgroups, chmod, setresgid, mount, setreuid } DEFAULT ALLOW"
